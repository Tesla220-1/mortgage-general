(("undefined"!==typeof self?self:this)["webpackJsonpcibwc"]=("undefined"!==typeof self?self:this)["webpackJsonpcibwc"]||[]).push([[6],{"7fdc":function(e,r,a){"use strict";a("caad"),a("c975"),a("d81d"),a("13d5"),a("b680"),a("cca6"),a("d3b7"),a("e6cf"),a("ac1f"),a("2532"),a("466d"),a("5319"),a("1276"),a("498a");var t=a("cf45"),s=a("33c0"),i=a("68b3"),n={props:{programms:{type:Array},sliderDataProp:{type:Object},incomeParams:{type:Object},region:{type:String}},components:{cibInput:s["a"],vueSlider:i["a"]},created:function(){this.init()},data:function(){return{changeSumFromSlider:!1,changePrepayFromSlider:!1,sliderData:this.sliderDataProp,prepaySliderRealValues:[],prepaySliderLabels:[],params:{sumSliderValue:null,prepaySliderValue:null,client:!0,ndfl2:!0,sum:null,prepay:null,period:1,ruralAreas:!1,mortgageTypes:this.incomeParams.mortgageTypes}}},computed:{sliderRealValues:function(){return this.sliderData.sliderRealValues},sliderLabels:function(){return this.sliderData.sliderLabels},sumSliderMax:function(){return this.sliderData.sliderRealValues.length-1},prepaySliderMax:function(){return this.prepaySliderRealValues.length-1},periodSliderMax:function(){return this.programms.reduce((function(e,r){var a=r.rates.reduce((function(e,r){return Math.max(e,r.maxPeriod)}),0);return Math.max(e,a)}),0)},prepayValueBoundary:function(){var e,r;return r=Math.round(this.params.sum*this.initPrepaymentPercentage),e=Math.round(r>=.95*this.params.sum&&this.sliderData.intervals?this.params.sum-Object(t["c"])(this.sliderData.intervals).intervalVal:.95*this.params.sum),{max:e,min:r}},initPrepaymentPercentage:function(){return this.programms.reduce((function(e,r){var a=r.rates.reduce((function(e,r){return Math.min(e,r.minInstalment)}),100);return Math.min(e,a)}),100)/100},creditSum:function(){return this.params.prepay?this.params.sum-this.params.prepay:this.params.sum},num:function(){return 12*this.params.period},prepaymentPercentage:function(){var e=100*this.params.prepay/this.params.sum;return Math.round(e.toFixed(2))}},methods:{init:function(){var e=this;return new Promise((function(r,a){e.createSliderValues(),e.params.sum=e.sliderRealValues[0],e.params.prepay=e.prepayValueBoundary.min,e.params=Object.assign(e.params,e.incomeParams),r()}))},sliderValueChanged:function(e){this[e]=!0},createSliderValues:function(){this.sliderData.intervals&&(this.sliderData.sliderRealValues=Object(t["c"])(this.sliderData.intervals).realValues,this.sliderData.sliderLabels=Object(t["c"])(this.sliderData.intervals).sliderValues)},createPrepaySliderValues:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.prepayValueBoundary.min,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.prepayValueBoundary.max,a=Object(t["d"])(3,Math.round(e),Math.round(r));this.prepaySliderRealValues=Object(t["c"])(a).realValues,this.prepaySliderLabels=Object(t["c"])(a).sliderValues},changePrepay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.prepayValueBoundary.min,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.prepayValueBoundary.max;this.params.prepay<=e?this.params.prepay=Math.round(e):this.params.prepay>=r&&(this.params.prepay=Math.round(r)),this.params.prepaySliderValue=this.prepaySliderRealValues.indexOf(Object(t["e"])(this.params.prepay,this.prepaySliderRealValues))},toggleHint:function(e){this.$emit("setHint",e)},isDesiredRegion:function(e){var r=e||"all",a="all"===r;if("all"!==r){var t=r.match(/\!/i);r=r.replace("!","");var s=r.split(",");s=s.map((function(e){return e.trim()})),a=t?!s.includes(this.region):s.includes(this.region)}return a}},watch:{"params.sum":function(){this.changeSumFromSlider=!1,this.params.sumSliderValue=this.sliderRealValues.indexOf(Object(t["e"])(this.params.sum,this.sliderRealValues)),this.createPrepaySliderValues(),this.changePrepay()},"params.prepay":function(){this.changePrepayFromSlider=!1,this.params.prepaySliderValue=this.prepaySliderRealValues.indexOf(Object(t["e"])(this.params.prepay,this.prepaySliderRealValues))},"params.sumSliderValue":function(){this.changeSumFromSlider&&(this.params.sum=this.sliderRealValues[this.params.sumSliderValue])},"params.prepaySliderValue":function(){this.changePrepayFromSlider&&(this.params.prepay=Math.round(this.prepaySliderRealValues[this.params.prepaySliderValue]))},finalProgramms:{handler:function(){this.$emit("calculationsCompleted",{finalProgramms:this.finalProgramms,paramsFromComponent:{sum:this.params.sum,creditSum:this.creditSum,period:this.params.period,prepay:this.params.prepay,initPrepaymentPercentage:100*this.initPrepaymentPercentage,client:this.params.client,ndfl2:this.params.ndfl2,ruralAreas:this.params.ruralAreas}})},deep:!0},errors:{handler:function(){this.$emit("onError",this.errors)},deep:!0}}};r["a"]=n},8593:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"mortgageComponent"},[a("div",{staticClass:"credCalc__group"},[a("cibInput",{attrs:{inputTag:"select",labelText:"Программа кредитования",fieldName:"select",required:!1},scopedSlots:e._u([{key:"selectOptions",fn:function(){return e._l(e.mortgageTypes,(function(r){return a("option",{key:r.value,domProps:{value:r.value}},[e._v(e._s(r.text))])}))},proxy:!0}]),model:{value:e.params.mortgageTypes.model,callback:function(r){e.$set(e.params.mortgageTypes,"model",r)},expression:"params.mortgageTypes.model"}})],1),e.currentMortgageTypeObject.nestedParams?a("div",{staticClass:"credCalc__checkboxes-wr checkboxes-wr"},[a("cibLink",{directives:[{name:"show",rawName:"v-show",value:"checkbox"===e.currentMortgageTypeObject.nestedParams.type,expression:"currentMortgageTypeObject.nestedParams.type === 'checkbox'"}],attrs:{blank:!0,href:e.currentProgramm.programm.url}},[e._v("Подробнее о программе")]),a("cibInput",{directives:[{name:"show",rawName:"v-show",value:"checkbox"===e.currentMortgageTypeObject.nestedParams.type,expression:"currentMortgageTypeObject.nestedParams.type === 'checkbox'"}],attrs:{fieldName:"postpravMoscow",inputType:"checkbox",checkBoxType:"toggle"},scopedSlots:e._u([{key:"labelText",fn:function(){return[e._v(" Жилье в Москве / Московской обл. "),a("sup",{staticClass:"credCalc__question",on:{click:function(r){return r.preventDefault(),e.toggleHint("mortgageMoscow")}}},[e._v("?")])]},proxy:!0}],null,!1,807974572),model:{value:e.currentMortgageTypeObject.nestedParams.model,callback:function(r){e.$set(e.currentMortgageTypeObject.nestedParams,"model",r)},expression:"currentMortgageTypeObject.nestedParams.model"}}),a("cibInput",{directives:[{name:"show",rawName:"v-show",value:"radio"===e.currentMortgageTypeObject.nestedParams.type,expression:"currentMortgageTypeObject.nestedParams.type === 'radio'"}],attrs:{inputType:"radio",fieldName:"purchaseAndRefinancing",itemsArr:e.currentMortgageTypeObject.nestedParams.params},model:{value:e.currentMortgageTypeObject.nestedParams.model,callback:function(r){e.$set(e.currentMortgageTypeObject.nestedParams,"model",r)},expression:"currentMortgageTypeObject.nestedParams.model"}})],1):e._e(),a("div",{staticClass:"credCalc__group credCalc__group_with-slider"},[a("cibInput",{attrs:{fieldName:"sum",labelText:"Cтоимость недвижимости (в рублях)",required:!1,replaceCharactersRegExp:/[^0-9]/g,sumFormatted:!0},model:{value:e.params.sum,callback:function(r){e.$set(e.params,"sum",r)},expression:"params.sum"}}),a("div",{staticClass:"element-wrapper-input"},[a("vue-slider",{ref:"sumSlider",attrs:{min:0,max:e.sumSliderMax,piecewise:!1,"piecewise-label":!0,tooltip:!1,"real-time":!1,"stop-propagation":!0,height:3,padding:0,dotSize:20,sliderStyle:{backgroundColor:"#50b848",boxShadow:"none"},processStyle:{backgroundColor:"#50b848"}},on:{callback:function(r){return e.sliderValueChanged("changeSumFromSlider")}},scopedSlots:e._u([{key:"label",fn:function(r){return a("span",{staticClass:"vue-slider-piecewise-label"},[e._v(e._s(e.sliderLabels[r.index]))])}}]),model:{value:e.params.sumSliderValue,callback:function(r){e.$set(e.params,"sumSliderValue",r)},expression:"params.sumSliderValue"}})],1)],1),a("div",{staticClass:"credCalc__group credCalc__group_with-slider"},[a("cibInput",{attrs:{fieldName:"prepay",labelText:"Первоначальный взнос (в рублях)",required:!1,replaceCharactersRegExp:/[^0-9]/g,sumFormatted:!0},model:{value:e.params.prepay,callback:function(r){e.$set(e.params,"prepay",r)},expression:"params.prepay"}}),a("div",{staticClass:"element-wrapper-input"},[a("vue-slider",{ref:"sumSlider",attrs:{min:0,max:e.prepaySliderMax,piecewise:!1,"piecewise-label":!0,tooltip:!1,"real-time":!1,"stop-propagation":!0,height:3,padding:0,dotSize:20,sliderStyle:{backgroundColor:"#50b848",boxShadow:"none"},processStyle:{backgroundColor:"#50b848"}},on:{callback:function(r){return e.sliderValueChanged("changePrepayFromSlider")}},scopedSlots:e._u([{key:"label",fn:function(r){return a("span",{staticClass:"vue-slider-piecewise-label"},[e._v(e._s(e.prepaySliderLabels[r.index]))])}}]),model:{value:e.params.prepaySliderValue,callback:function(r){e.$set(e.params,"prepaySliderValue",r)},expression:"params.prepaySliderValue"}})],1)],1),a("div",{staticClass:"credCalc__group credCalc__group_with-slider"},[a("cibInput",{attrs:{fieldName:"period",labelText:"Срок кредитования (в годах)",required:!1,replaceCharactersRegExp:/[^0-9]/g,sumFormatted:!0},model:{value:e.params.period,callback:function(r){e.$set(e.params,"period",r)},expression:"params.period"}}),a("div",{staticClass:"element-wrapper-input"},[a("vue-slider",{ref:"periodSlider",attrs:{min:1,max:e.periodSliderMax,piecewise:!1,"piecewise-label":!0,tooltip:!1,moveLinkByIndex:!0,height:3,padding:0,dotSize:20,sliderStyle:{backgroundColor:"#50b848",boxShadow:"none"},processStyle:{backgroundColor:"#50b848"}},model:{value:e.params.period,callback:function(r){e.$set(e.params,"period",r)},expression:"params.period"}})],1)],1)])},s=[],i=(a("a4d3"),a("e01a"),a("4de4"),a("7db0"),a("4160"),a("13d5"),a("45fc"),a("b0c0"),a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("159b"),a("96cf"),a("1da1")),n=a("7fdc"),m=a("cf45"),o=a("8d1f"),p={name:"mortgage",mixins:[n["a"]],components:{cibLink:o["a"]},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.init();case 2:e.createPrepaySliderValues(e.currentProgrammTypePrepayValueBoundary.min,e.currentProgrammTypePrepayValueBoundary.max),e.changePrepay(e.currentProgrammTypePrepayValueBoundary.min,e.currentProgrammTypePrepayValueBoundary.max);case 4:case"end":return r.stop()}}),r)})))()},computed:{currentMortgageTypeObject:function(){var e=this;return this.params.mortgageTypes.types.find((function(r){return r.value===e.params.mortgageTypes.model}))},suitableProgramms:function(){var e=this,r=[];return this.programms.forEach((function(a){var t=a.name,s=a.rates,i=a.url,n=a.description,m=a.mortgageType,o=a.region,p=a.ratesSplit,u=void 0!==p&&p,l=e.isDesiredRegion(o),c=[];s.forEach((function(r){var a=r.minPeriod,t=r.rateValue,s=r.minInstalment,i=r.maxInstalment;e.params.period>=a&&s<=e.prepaymentPercentage&&e.prepaymentPercentage<=i&&l&&(u?c.push({minPeriod:a,rateValue:t}):c=[{minPeriod:a,rateValue:t}])})),s.forEach((function(a){var s=a.minPeriod,o=a.maxPeriod,p=a.minSum,u=a.maxSum,d=a.minCreditSum,g=void 0===d?0:d,h=a.maxCreditSum,y=void 0===h?2147483647:h,f=a.minInstalment,P=a.maxInstalment,b=!!e.currentMortgageTypeObject.hasOwnProperty("nestedParams")&&m===e.currentMortgageTypeObject.nestedParams.model;e.currentMortgageTypeObject.hasOwnProperty("nestedParams")&&"postprav"===m&&(y=e.currentMortgageTypeObject.nestedParams.model?12e6:y),e.currentMortgageTypeObject.hasOwnProperty("nestedParams")&&"postprav65"===m&&(y=e.currentMortgageTypeObject.nestedParams.model?12e6:y),p<=e.params.sum&&e.params.sum<=u&&g<=e.creditSum&&e.creditSum<=y&&f<=e.prepaymentPercentage&&e.prepaymentPercentage<=P&&s<=e.params.period&&e.params.period<=o&&(m===e.params.mortgageTypes.model||b)&&l&&r.push({name:t,url:i,description:n,minSum:p,maxSum:u,minCreditSum:g,maxCreditSum:y,ratesArr:c,mortgageType:m})}))})),r},finalProgramms:function(){var e=this,r=[];return this.suitableProgramms.forEach((function(a){var t=a.name,s=a.url,i=a.description,n=a.mortgageType,o=[];a.ratesArr.forEach((function(r){var a=r.rateValue,t=r.minPeriod;if(e.params.period>=t){var s=a/100/12,i=s*Math.pow(1+s,e.num-1)/(Math.pow(1+s,e.num-1)-1);"postprav"!==n&&"postprav65"!==n&&"village"!==n||(i=s*Math.pow(1+s,e.num)/(Math.pow(1+s,e.num)-1));var p=e.creditSum*i;o.push({pay:Object(m["f"])(p.toFixed(0).toString()),rateValue:a.toFixed(2).toString().replace(".",","),minPeriod:t})}})),console.log(o),r.push({name:t,url:s,description:i,paysArr:o})})),r},currentProgramm:function(){var e=this,r=this.programms.find((function(r){return e.params.mortgageTypes.model===r.mortgageType}))||this.programms.find((function(r){return e.currentMortgageTypeObject.nestedParams.model===r.mortgageType})),a=r.rates.reduce((function(e,r){return Math.min(e,r.minInstalment)}),100)/100,t=r.rates[0].maxCreditSum?r.rates[0].maxCreditSum:r.rates[0].maxSum,s=r.rates.reduce((function(e,r){return Math.max(e,r.maxPeriod)}),0);this.currentMortgageTypeObject.hasOwnProperty("nestedParams")&&"postprav"===r.mortgageType&&(t=this.currentMortgageTypeObject.nestedParams.model?12e6:t),this.currentMortgageTypeObject.hasOwnProperty("nestedParams")&&"postprav65"===r.mortgageType&&(t=this.currentMortgageTypeObject.nestedParams.model?12e6:t);var i={minSum:r.rates[0].minSum,minCreditSum:r.rates[0].minCreditSum?r.rates[0].minCreditSum:0,maxCreditSum:t,maxPeriod:s,url:r.url};return{typePrepaymentPercentage:a,programm:i}},currentProgrammTypePrepayValueBoundary:function(){var e,r;return r=Math.round(this.params.sum*this.currentProgramm.typePrepaymentPercentage),e=Math.round(r>=.95*this.params.sum&&this.sliderData.intervals?this.params.sum-Object(m["c"])(this.sliderData.intervals).intervalVal:.95*this.params.sum),("village"===this.currentMortgageTypeObject.value||"postprav"===this.currentMortgageTypeObject.value||"postprav65"===this.currentMortgageTypeObject.value||"parkingSpaces"===this.currentMortgageTypeObject.value)&&this.params.sum-r>this.currentProgramm.programm.maxCreditSum&&(r=this.params.sum-this.currentProgramm.programm.maxCreditSum),{max:e,min:r}},errors:function(){var e=[],r=[{isError:this.params.prepay<this.currentProgrammTypePrepayValueBoundary.min,errorMessage:"Сумма первоначального взноса должна быть не менее ".concat(Object(m["f"])(this.currentProgrammTypePrepayValueBoundary.min)," руб.")},{isError:this.params.prepay>this.currentProgrammTypePrepayValueBoundary.max,errorMessage:"Сумма первоначального взноса не должна превышать ".concat(Object(m["f"])(this.currentProgrammTypePrepayValueBoundary.max)," руб.")},{isError:this.params.sum<this.currentProgramm.programm.minSum,errorMessage:"Стоимость недвижимости должна быть не менее <br/> ".concat(Object(m["f"])(this.currentProgramm.programm.minSum)," руб.")},{isError:this.creditSum<this.currentProgramm.programm.minCreditSum&&this.creditSum>0,errorMessage:"Сумма кредита должна быть не менее <br/> ".concat(Object(m["f"])(this.currentProgramm.programm.minCreditSum)," руб.")},{isError:this.creditSum>this.currentProgramm.programm.maxCreditSum,errorMessage:"Сумма кредита не должна превышать <br/> ".concat(Object(m["f"])(this.currentProgramm.programm.maxCreditSum)," руб.")},{isError:this.params.period>this.currentProgramm.programm.maxPeriod,errorMessage:"Срок кредитования не должен превышать <br/> ".concat(this.currentProgramm.programm.maxPeriod," лет")}];return r.forEach((function(r){r.isError&&e.push(r.errorMessage)})),{isError:r.some((function(e){return e.isError})),errorMessages:e}},mortgageTypes:function(){var e=this;return this.params.mortgageTypes.types.filter((function(r){return e.isDesiredRegion(r.region)}))}},watch:{"params.mortgageTypes.model":function(){this.createPrepaySliderValues(this.currentProgrammTypePrepayValueBoundary.min,this.currentProgrammTypePrepayValueBoundary.max),this.changePrepay(this.currentProgrammTypePrepayValueBoundary.min,this.currentProgrammTypePrepayValueBoundary.max)},"params.sum":function(){this.createPrepaySliderValues(this.currentProgrammTypePrepayValueBoundary.min,this.currentProgrammTypePrepayValueBoundary.max),this.changePrepay(this.currentProgrammTypePrepayValueBoundary.min,this.currentProgrammTypePrepayValueBoundary.max)},finalProgramms:{handler:function(){this.$emit("calculationsCompleted",{finalProgramms:this.finalProgramms,paramsFromComponent:{initPrepaymentPercentage:100*this.currentProgramm.typePrepaymentPercentage,currentMortgageTypeObject:this.currentMortgageTypeObject}})},deep:!0}}},u=p,l=a("2877"),c=Object(l["a"])(u,t,s,!1,null,null,null);r["default"]=c.exports}}]);
//# sourceMappingURL=cibwc.umd.min.6.js.map